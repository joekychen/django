<!DOCTYPE html>
<html><head><title>joekychen/django » django › contrib › gis › geos › tests › test_geos.py

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>test_geos.py</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">from</span> <span class="nn">django.contrib.gis.geos</span> <span class="kn">import</span> <span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">GEOSGeometry</span><span class="p">,</span>
    <span class="n">GeometryCollection</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="n">MultiPoint</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">,</span> <span class="n">MultiPolygon</span><span class="p">,</span> <span class="n">LinearRing</span><span class="p">,</span>
    <span class="n">LineString</span><span class="p">,</span> <span class="n">MultiLineString</span><span class="p">,</span> <span class="n">fromfile</span><span class="p">,</span> <span class="n">fromstr</span><span class="p">,</span> <span class="n">geos_version_info</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">django.contrib.gis.geos.base</span> <span class="kn">import</span> <span class="n">gdal</span><span class="p">,</span> <span class="n">numpy</span><span class="p">,</span> <span class="n">GEOSBase</span>
<span class="kn">from</span> <span class="nn">django.contrib.gis.geos.libgeos</span> <span class="kn">import</span> <span class="n">GEOS_PREPARE</span>
<span class="kn">from</span> <span class="nn">django.contrib.gis.geometry.test_data</span> <span class="kn">import</span> <span class="n">TestDataMixin</span>

<span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">unittest</span>


<span class="k">class</span> <span class="nc">GEOSTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">,</span> <span class="n">TestDataMixin</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">null_srid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the proper null SRID depending on the GEOS version.</span>
<span class="sd">        See the comments in `test_srid` for more details.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">geos_version_info</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s">&#39;version&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;3.0.0&#39;</span> <span class="ow">and</span> <span class="n">info</span><span class="p">[</span><span class="s">&#39;release_candidate&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">test_base</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Tests out the GEOSBase class.&quot;</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>Testing out GEOSBase class, which provides a <code>ptr</code> property
that abstracts out access to underlying C pointers.</p></td><td class="code"><div class="highlight"><pre>        <span class="k">class</span> <span class="nc">FakeGeom1</span><span class="p">(</span><span class="n">GEOSBase</span><span class="p">):</span>
            <span class="k">pass</span></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>This one only accepts pointers to floats</p></td><td class="code"><div class="highlight"><pre>        <span class="n">c_float_p</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">)</span>
        <span class="k">class</span> <span class="nc">FakeGeom2</span><span class="p">(</span><span class="n">GEOSBase</span><span class="p">):</span>
            <span class="n">ptr_type</span> <span class="o">=</span> <span class="n">c_float_p</span></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><p>Default ptr_type is <code>c_void_p</code>.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">fg1</span> <span class="o">=</span> <span class="n">FakeGeom1</span><span class="p">()</span></pre></div></td></tr>


<tr id="section-5"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-5">&#182;</a></div><p>Default ptr_type is C float pointer</p></td><td class="code"><div class="highlight"><pre>        <span class="n">fg2</span> <span class="o">=</span> <span class="n">FakeGeom2</span><span class="p">()</span></pre></div></td></tr>


<tr id="section-6"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-6">&#182;</a></div><p>These assignments are OK -- None is allowed because
it's equivalent to the NULL pointer.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">fg1</span><span class="o">.</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">()</span>
        <span class="n">fg1</span><span class="o">.</span><span class="n">ptr</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">fg2</span><span class="o">.</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">c_float_p</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="mf">5.23</span><span class="p">))</span>
        <span class="n">fg2</span><span class="o">.</span><span class="n">ptr</span> <span class="o">=</span> <span class="bp">None</span></pre></div></td></tr>


<tr id="section-7"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-7">&#182;</a></div><p>Because pointers have been set to NULL, an exception should be
raised when we try to access it.  Raising an exception is
preferrable to a segmentation fault that commonly occurs when
a C method is given a NULL memory reference.</p></td><td class="code"><div class="highlight"><pre>        <span class="k">for</span> <span class="n">fg</span> <span class="ow">in</span> <span class="p">(</span><span class="n">fg1</span><span class="p">,</span> <span class="n">fg2</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-8"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-8">&#182;</a></div><p>Equivalent to <code>fg.ptr</code></p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">_get_ptr</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-9"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-9">&#182;</a></div><p>Anything that is either not None or the acceptable pointer type will
result in a TypeError when trying to assign it to the <code>ptr</code> property.
Thus, memmory addresses (integers) and pointers of the incorrect type
(in <code>bad_ptrs</code>) will not be allowed.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">bad_ptrs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">(</span><span class="s">&#39;foobar&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">bad_ptr</span> <span class="ow">in</span> <span class="n">bad_ptrs</span><span class="p">:</span></pre></div></td></tr>


<tr id="section-10"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-10">&#182;</a></div><p>Equivalent to <code>fg.ptr = bad_ptr</code></p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">fg1</span><span class="o">.</span><span class="n">_set_ptr</span><span class="p">,</span> <span class="n">bad_ptr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">fg2</span><span class="o">.</span><span class="n">_set_ptr</span><span class="p">,</span> <span class="n">bad_ptr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_wkt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing WKT output.&quot;</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">wkt_out</span><span class="p">:</span>
            <span class="n">geom</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">ewkt</span><span class="p">,</span> <span class="n">geom</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_hex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing HEX output.&quot;</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">hex_wkt</span><span class="p">:</span>
            <span class="n">geom</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">hex</span><span class="p">,</span> <span class="n">geom</span><span class="o">.</span><span class="n">hex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_hexewkb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing (HEX)EWKB output.&quot;</span>
        <span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">a2b_hex</span></pre></div></td></tr>


<tr id="section-11"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-11">&#182;</a></div><p>For testing HEX(EWKB).</p></td><td class="code"><div class="highlight"><pre>        <span class="n">ogc_hex</span> <span class="o">=</span> <span class="s">&#39;01010000000000000000000000000000000000F03F&#39;</span></pre></div></td></tr>


<tr id="section-12"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-12">&#182;</a></div><p><code>SELECT ST_AsHEXEWKB(ST_GeomFromText('POINT(0 1)', 4326));</code></p></td><td class="code"><div class="highlight"><pre>        <span class="n">hexewkb_2d</span> <span class="o">=</span> <span class="s">&#39;0101000020E61000000000000000000000000000000000F03F&#39;</span></pre></div></td></tr>


<tr id="section-13"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-13">&#182;</a></div><p><code>SELECT ST_AsHEXEWKB(ST_GeomFromEWKT('SRID=4326;POINT(0 1 2)'));</code></p></td><td class="code"><div class="highlight"><pre>        <span class="n">hexewkb_3d</span> <span class="o">=</span> <span class="s">&#39;01010000A0E61000000000000000000000000000000000F03F0000000000000040&#39;</span>

        <span class="n">pnt_2d</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span>
        <span class="n">pnt_3d</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-14"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-14">&#182;</a></div><p>OGC-compliant HEX will not have SRID nor Z value.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ogc_hex</span><span class="p">,</span> <span class="n">pnt_2d</span><span class="o">.</span><span class="n">hex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ogc_hex</span><span class="p">,</span> <span class="n">pnt_3d</span><span class="o">.</span><span class="n">hex</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-15"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-15">&#182;</a></div><p>HEXEWKB should be appropriate for its dimension -- have to use an
a WKBWriter w/dimension set accordingly, else GEOS will insert
garbage into 3D coordinate if there is none.  Also, GEOS has a
a bug in versions prior to 3.1 that puts the X coordinate in
place of Z; an exception should be raised on those versions.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">hexewkb_2d</span><span class="p">,</span> <span class="n">pnt_2d</span><span class="o">.</span><span class="n">hexewkb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">GEOS_PREPARE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">hexewkb_3d</span><span class="p">,</span> <span class="n">pnt_3d</span><span class="o">.</span><span class="n">hexewkb</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="n">hexewkb_3d</span><span class="p">)</span><span class="o">.</span><span class="n">hasz</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">hexewkb</span> <span class="o">=</span> <span class="n">pnt_3d</span><span class="o">.</span><span class="n">hexewkb</span>
            <span class="k">except</span> <span class="n">GEOSException</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;Should have raised GEOSException.&#39;</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-16"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-16">&#182;</a></div><p>Same for EWKB.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">buffer</span><span class="p">(</span><span class="n">a2b_hex</span><span class="p">(</span><span class="n">hexewkb_2d</span><span class="p">)),</span> <span class="n">pnt_2d</span><span class="o">.</span><span class="n">ewkb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">GEOS_PREPARE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">buffer</span><span class="p">(</span><span class="n">a2b_hex</span><span class="p">(</span><span class="n">hexewkb_3d</span><span class="p">)),</span> <span class="n">pnt_3d</span><span class="o">.</span><span class="n">ewkb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ewkb</span> <span class="o">=</span> <span class="n">pnt_3d</span><span class="o">.</span><span class="n">ewkb</span>
            <span class="k">except</span> <span class="n">GEOSException</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;Should have raised GEOSException&#39;</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-17"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-17">&#182;</a></div><p>Redundant sanity check.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">4326</span><span class="p">,</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="n">hexewkb_2d</span><span class="p">)</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_kml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing KML output.&quot;</span>
        <span class="k">for</span> <span class="n">tg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">wkt_out</span><span class="p">:</span>
            <span class="n">geom</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="n">kml</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">tg</span><span class="p">,</span> <span class="s">&#39;kml&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">kml</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">kml</span><span class="p">,</span> <span class="n">geom</span><span class="o">.</span><span class="n">kml</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing the Error handlers.&quot;</span></pre></div></td></tr>


<tr id="section-18"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-18">&#182;</a></div><p>string-based</p></td><td class="code"><div class="highlight"><pre>        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">BEGIN - expecting GEOS_ERROR; safe to ignore.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="k">pass</span></pre></div></td></tr>


<tr id="section-19"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-19">&#182;</a></div><p>Bad WKB</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="n">GEOSGeometry</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">))</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">END - expecting GEOS_ERROR; safe to ignore.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">NotAGeometry</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span></pre></div></td></tr>


<tr id="section-20"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-20">&#182;</a></div><p>Some other object</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">GEOSGeometry</span><span class="p">,</span> <span class="n">NotAGeometry</span><span class="p">())</span></pre></div></td></tr>


<tr id="section-21"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-21">&#182;</a></div><p>None</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">GEOSGeometry</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_wkb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing WKB output.&quot;</span>
        <span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">b2a_hex</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">hex_wkt</span><span class="p">:</span>
            <span class="n">geom</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="n">wkb</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">wkb</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">b2a_hex</span><span class="p">(</span><span class="n">wkb</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">hex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_create_hex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing creation from HEX.&quot;</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">hex_wkt</span><span class="p">:</span>
            <span class="n">geom_h</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">hex</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-22"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-22">&#182;</a></div><p>we need to do this so decimal places get normalised</p></td><td class="code"><div class="highlight"><pre>            <span class="n">geom_t</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">geom_t</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">geom_h</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_create_wkb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing creation from WKB.&quot;</span>
        <span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">a2b_hex</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">hex_wkt</span><span class="p">:</span>
            <span class="n">wkb</span> <span class="o">=</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">a2b_hex</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">hex</span><span class="p">))</span>
            <span class="n">geom_h</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="n">wkb</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-23"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-23">&#182;</a></div><p>we need to do this so decimal places get normalised</p></td><td class="code"><div class="highlight"><pre>            <span class="n">geom_t</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">geom_t</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">geom_h</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_ewkt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing EWKT.&quot;</span>
        <span class="n">srids</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32140</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">srid</span> <span class="ow">in</span> <span class="n">srids</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">polygons</span><span class="p">:</span>
                <span class="n">ewkt</span> <span class="o">=</span> <span class="s">&#39;SRID=</span><span class="si">%d</span><span class="s">;</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">srid</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
                <span class="n">poly</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">ewkt</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">srid</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">srid</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">srid</span><span class="p">,</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">ewkt</span><span class="p">)</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span> <span class="c"># Checking export</span>

    <span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="n">gdal</span><span class="o">.</span><span class="n">HAS_GDAL</span> <span class="ow">and</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GEOJSON</span><span class="p">,</span> <span class="s">&quot;gdal &gt;= 1.5 is required&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing GeoJSON input/output (via GDAL).&quot;</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">json_geoms</span><span class="p">:</span>
            <span class="n">geom</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s">&#39;not_equal&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">json</span><span class="p">,</span> <span class="n">geom</span><span class="o">.</span><span class="n">json</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">json</span><span class="p">,</span> <span class="n">geom</span><span class="o">.</span><span class="n">geojson</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">GEOSGeometry</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">wkt</span><span class="p">),</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="n">geom</span><span class="o">.</span><span class="n">json</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_fromfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing the fromfile() factory.&quot;</span>
        <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
        <span class="n">ref_pnt</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT(5 23)&#39;</span><span class="p">)</span>

        <span class="n">wkt_f</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">wkt_f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ref_pnt</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
        <span class="n">wkb_f</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">wkb_f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ref_pnt</span><span class="o">.</span><span class="n">wkb</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-24"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-24">&#182;</a></div><p>Other tests use <code>fromfile()</code> on string filenames so those
aren't tested here.</p></td><td class="code"><div class="highlight"><pre>        <span class="k">for</span> <span class="n">fh</span> <span class="ow">in</span> <span class="p">(</span><span class="n">wkt_f</span><span class="p">,</span> <span class="n">wkb_f</span><span class="p">):</span>
            <span class="n">fh</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">pnt</span> <span class="o">=</span> <span class="n">fromfile</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ref_pnt</span><span class="p">,</span> <span class="n">pnt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_eq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing equivalence.&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;POINT(5 23)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">)</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;LINESTRING(0 0, 1 1, 5 5)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">ls</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-25"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-25">&#182;</a></div><p>Error shouldn't be raise on equivalence testing with
an invalid type.</p></td><td class="code"><div class="highlight"><pre>        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ls</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;foo&#39;</span> <span class="p">:</span> <span class="s">&#39;bar&#39;</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing Point objects.&quot;</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;POINT(0 0)&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">points</span><span class="p">:</span></pre></div></td></tr>


<tr id="section-26"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-26">&#182;</a></div><p>Creating the point from the WKT</p></td><td class="code"><div class="highlight"><pre>            <span class="n">pnt</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pnt</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;Point&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pnt</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">pnt</span> <span class="o">==</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">wkt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">pnt</span> <span class="o">==</span> <span class="n">prev</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-27"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-27">&#182;</a></div><p>Making sure that the point's X, Y components are what we expect</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-28"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-28">&#182;</a></div><p>Testing the third dimension, and getting the tuple arguments</p></td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">hasz</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">tuple</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span>
                <span class="n">tup_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
                <span class="n">set_tup1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.71</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">5.23</span><span class="p">)</span>
                <span class="n">set_tup2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5.23</span><span class="p">,</span> <span class="mf">2.71</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">hasz</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
                <span class="n">tup_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
                <span class="n">set_tup1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.71</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)</span>
                <span class="n">set_tup2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">2.71</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-29"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-29">&#182;</a></div><p>Centroid operation on point should be point itself</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-30"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-30">&#182;</a></div><p>Now testing the different constructors</p></td><td class="code"><div class="highlight"><pre>            <span class="n">pnt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">tup_args</span><span class="p">)</span>  <span class="c"># e.g., Point((1, 2))</span>
            <span class="n">pnt3</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="o">*</span><span class="n">tup_args</span><span class="p">)</span> <span class="c"># e.g., Point(1, 2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">pnt</span> <span class="o">==</span> <span class="n">pnt2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">pnt</span> <span class="o">==</span> <span class="n">pnt3</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-31"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-31">&#182;</a></div><p>Now testing setting the x and y</p></td><td class="code"><div class="highlight"><pre>            <span class="n">pnt</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mf">3.14</span>
            <span class="n">pnt</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mf">2.71</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">3.14</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">2.71</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-32"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-32">&#182;</a></div><p>Setting via the tuple/coords property</p></td><td class="code"><div class="highlight"><pre>            <span class="n">pnt</span><span class="o">.</span><span class="n">tuple</span> <span class="o">=</span> <span class="n">set_tup1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">set_tup1</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span>
            <span class="n">pnt</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">set_tup2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">set_tup2</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>

            <span class="n">prev</span> <span class="o">=</span> <span class="n">pnt</span> <span class="c"># setting the previous geometry</span>

    <span class="k">def</span> <span class="nf">test_multipoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing MultiPoint objects.&quot;</span>
        <span class="k">for</span> <span class="n">mp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">multipoints</span><span class="p">:</span>
            <span class="n">mpnt</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mpnt</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;MultiPoint&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mpnt</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mpnt</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mpnt</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">mpnt</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mpnt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">mpnt</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">tuple</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mpnt</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">mpnt</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;Point&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">empty</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">valid</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_linestring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing LineString objects.&quot;</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;POINT(0 0)&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">linestrings</span><span class="p">:</span>
            <span class="n">ls</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;LineString&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">empty</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">ring</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&#39;centroid&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">ls</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s">&#39;tup&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">tup</span><span class="p">,</span> <span class="n">ls</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span> <span class="o">==</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">wkt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">ls</span> <span class="o">==</span> <span class="n">prev</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">ls</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">))</span>
            <span class="n">prev</span> <span class="o">=</span> <span class="n">ls</span></pre></div></td></tr>


<tr id="section-33"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-33">&#182;</a></div><p>Creating a LineString from a tuple, list, and numpy array</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">LineString</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">tuple</span><span class="p">))</span>  <span class="c"># tuple</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">LineString</span><span class="p">(</span><span class="o">*</span><span class="n">ls</span><span class="o">.</span><span class="n">tuple</span><span class="p">))</span> <span class="c"># as individual arguments</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">LineString</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">tuple</span><span class="p">]))</span> <span class="c"># as list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">LineString</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">tuple</span><span class="p">))</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span> <span class="c"># Point individual arguments</span>
            <span class="k">if</span> <span class="n">numpy</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">LineString</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">tuple</span><span class="p">)))</span> <span class="c"># as numpy array</span>

    <span class="k">def</span> <span class="nf">test_multilinestring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing MultiLineString objects.&quot;</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;POINT(0 0)&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">multilinestrings</span><span class="p">:</span>
            <span class="n">ml</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ml</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;MultiLineString&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ml</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ml</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ml</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ml</span> <span class="o">==</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">wkt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">ml</span> <span class="o">==</span> <span class="n">prev</span><span class="p">)</span>
            <span class="n">prev</span> <span class="o">=</span> <span class="n">ml</span>

            <span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">ml</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;LineString&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">empty</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">ml</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ml</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ml</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">MultiLineString</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ml</span><span class="p">))</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ml</span><span class="p">,</span> <span class="n">MultiLineString</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="n">LineString</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ml</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">test_linearring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing LinearRing objects.&quot;</span>
        <span class="k">for</span> <span class="n">rr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">linearrings</span><span class="p">:</span>
            <span class="n">lr</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">rr</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;LinearRing&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rr</span><span class="o">.</span><span class="n">n_p</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lr</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-34"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-34">&#182;</a></div><p>Creating a LinearRing from a tuple, list, and numpy array</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">LinearRing</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">tuple</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">LinearRing</span><span class="p">(</span><span class="o">*</span><span class="n">lr</span><span class="o">.</span><span class="n">tuple</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">LinearRing</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">lr</span><span class="o">.</span><span class="n">tuple</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">numpy</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">LinearRing</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">tuple</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">test_polygons_from_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing `from_bbox` class method.&quot;</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Polygon</span><span class="o">.</span><span class="n">from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-35"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-35">&#182;</a></div><p>Testing numerical precision</p></td><td class="code"><div class="highlight"><pre>        <span class="n">x</span> <span class="o">=</span> <span class="mf">3.14159265358979323</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Polygon</span><span class="o">.</span><span class="n">from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">extent</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;.13f&#39;</span><span class="p">),</span> <span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s">&#39;.13f&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_polygons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing Polygon objects.&quot;</span>

        <span class="n">prev</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;POINT(0 0)&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">polygons</span><span class="p">:</span></pre></div></td></tr>


<tr id="section-36"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-36">&#182;</a></div><p>Creating the Polygon, testing its properties.</p></td><td class="code"><div class="highlight"><pre>            <span class="n">poly</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;Polygon&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">empty</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">ring</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">n_i</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">num_interior_rings</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">n_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">))</span> <span class="c"># Testing __len__</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">n_p</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">num_points</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-37"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-37">&#182;</a></div><p>Area &amp; Centroid</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">poly</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-38"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-38">&#182;</a></div><p>Testing the geometry equivalence</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">poly</span> <span class="o">==</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">wkt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">poly</span> <span class="o">==</span> <span class="n">prev</span><span class="p">)</span> <span class="c"># Should not be equal to previous geometry</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">poly</span> <span class="o">!=</span> <span class="n">prev</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-39"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-39">&#182;</a></div><p>Testing the exterior ring</p></td><td class="code"><div class="highlight"><pre>            <span class="n">ring</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">exterior_ring</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ring</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;LinearRing&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ring</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">ext_ring_cs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">ext_ring_cs</span><span class="p">,</span> <span class="n">ring</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">ext_ring_cs</span><span class="p">,</span> <span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span> <span class="c"># Testing __getitem__</span></pre></div></td></tr>


<tr id="section-40"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-40">&#182;</a></div><p>Testing <strong>getitem</strong> and <strong>setitem</strong> on invalid indices</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">),</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-41"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-41">&#182;</a></div><p>Testing <strong>iter</strong></p></td><td class="code"><div class="highlight"><pre>            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;LinearRing&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-42"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-42">&#182;</a></div><p>Testing polygon construction.</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Polygon</span><span class="o">.</span><span class="n">__init__</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Polygon</span><span class="o">.</span><span class="n">__init__</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-43"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-43">&#182;</a></div><p>Polygon(shell, (hole1, ... holeN))</p></td><td class="code"><div class="highlight"><pre>            <span class="n">rings</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">rings</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rings</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span></pre></div></td></tr>


<tr id="section-44"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-44">&#182;</a></div><p>Polygon(shell<em>tuple, hole</em>tuple1, ... , hole_tupleN)</p></td><td class="code"><div class="highlight"><pre>            <span class="n">ring_tuples</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">tuple</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">(</span><span class="o">*</span><span class="n">ring_tuples</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-45"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-45">&#182;</a></div><p>Constructing with tuples of LinearRings.</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">))</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="n">LinearRing</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">))</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_multipolygons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing MultiPolygon objects.&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">BEGIN - expecting GEOS_NOTICE; safe to ignore.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;POINT (0 0)&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">multipolygons</span><span class="p">:</span>
            <span class="n">mpoly</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mpoly</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;MultiPolygon&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mpoly</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">valid</span><span class="p">,</span> <span class="n">mpoly</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mp</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">num_geom</span><span class="p">,</span> <span class="n">mpoly</span><span class="o">.</span><span class="n">num_geom</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">n_p</span><span class="p">,</span> <span class="n">mpoly</span><span class="o">.</span><span class="n">num_coords</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">num_geom</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mpoly</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">mpoly</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mpoly</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">mpoly</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">geom_type</span><span class="p">,</span> <span class="s">&#39;Polygon&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">geom_typeid</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">valid</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mpoly</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">MultiPolygon</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">mpoly</span><span class="p">))</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">END - expecting GEOS_NOTICE; safe to ignore.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_memory_hijinks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing Geometry __del__() on rings and polygons.&quot;</span></pre></div></td></tr>


<tr id="section-46"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-46">&#182;</a></div><h3>Memory issues with rings and polygons</h3></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-47"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-47">&#182;</a></div><p>These tests are needed to ensure sanity with writable geometries.</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-48"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-48">&#182;</a></div><p>Getting a polygon with interior rings, and pulling out the interior rings</p></td><td class="code"><div class="highlight"><pre>        <span class="n">poly</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
        <span class="n">ring1</span> <span class="o">=</span> <span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ring2</span> <span class="o">=</span> <span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></pre></div></td></tr>


<tr id="section-49"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-49">&#182;</a></div><p>These deletes should be 'harmless' since they are done on child geometries</p></td><td class="code"><div class="highlight"><pre>        <span class="k">del</span> <span class="n">ring1</span>
        <span class="k">del</span> <span class="n">ring2</span>
        <span class="n">ring1</span> <span class="o">=</span> <span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ring2</span> <span class="o">=</span> <span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></pre></div></td></tr>


<tr id="section-50"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-50">&#182;</a></div><p>Deleting the polygon</p></td><td class="code"><div class="highlight"><pre>        <span class="k">del</span> <span class="n">poly</span></pre></div></td></tr>


<tr id="section-51"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-51">&#182;</a></div><p>Access to these rings is OK since they are clones.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ring1</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">ring2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_coord_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing Coordinate Sequence objects.&quot;</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">polygons</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">ext_ring_cs</span><span class="p">:</span></pre></div></td></tr>


<tr id="section-52"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-52">&#182;</a></div><p>Constructing the polygon and getting the coordinate sequence</p></td><td class="code"><div class="highlight"><pre>                <span class="n">poly</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
                <span class="n">cs</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">exterior_ring</span><span class="o">.</span><span class="n">coord_seq</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">ext_ring_cs</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span> <span class="c"># done in the Polygon test too.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">ext_ring_cs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">cs</span><span class="p">))</span> <span class="c"># Making sure __len__ works</span></pre></div></td></tr>


<tr id="section-53"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-53">&#182;</a></div><p>Checks <strong>getitem</strong> and <strong>setitem</strong></p></td><td class="code"><div class="highlight"><pre>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">ext_ring_cs</span><span class="p">)):</span>
                    <span class="n">c1</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">ext_ring_cs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c"># Expected value</span>
                    <span class="n">c2</span> <span class="o">=</span> <span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c"># Value from coordseq</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-54"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-54">&#182;</a></div><p>Constructing the test value to set the coordinate sequence with</p></td><td class="code"><div class="highlight"><pre>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="n">tset</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span> <span class="n">tset</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
                    <span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tset</span></pre></div></td></tr>


<tr id="section-55"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-55">&#182;</a></div><p>Making sure every set point matches what we expect</p></td><td class="code"><div class="highlight"><pre>                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tset</span><span class="p">)):</span>
                        <span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tset</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tset</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_relate_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing relate() and relate_pattern().&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;POINT (0 0)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">relate_pattern</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;invalid pattern, yo&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">relate_geoms</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">rg</span><span class="o">.</span><span class="n">wkt_a</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">rg</span><span class="o">.</span><span class="n">wkt_b</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rg</span><span class="o">.</span><span class="n">result</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">relate_pattern</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">rg</span><span class="o">.</span><span class="n">pattern</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rg</span><span class="o">.</span><span class="n">pattern</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">relate</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_intersection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing intersects() and intersection().&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">)):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt_a</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt_b</span><span class="p">)</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">intersect_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">a</span> <span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="c"># __and__ is intersection operator</span>
            <span class="n">a</span> <span class="o">&amp;=</span> <span class="n">b</span> <span class="c"># testing __iand__</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_union</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing union().&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">)):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt_a</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt_b</span><span class="p">)</span>
            <span class="n">u1</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">union_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="n">u2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">a</span> <span class="o">|</span> <span class="n">b</span><span class="p">)</span> <span class="c"># __or__ is union operator</span>
            <span class="n">a</span> <span class="o">|=</span> <span class="n">b</span> <span class="c"># testing __ior__</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing difference().&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">)):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt_a</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt_b</span><span class="p">)</span>
            <span class="n">d1</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">diff_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="n">d2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="c"># __sub__ is difference operator</span>
            <span class="n">a</span> <span class="o">-=</span> <span class="n">b</span> <span class="c"># testing __isub__</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_symdifference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing sym_difference().&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">)):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt_a</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">topology_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt_b</span><span class="p">)</span>
            <span class="n">d1</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">sdiff_geoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="n">d2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">sym_difference</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">a</span> <span class="o">^</span> <span class="n">b</span><span class="p">)</span> <span class="c"># __xor__ is symmetric difference operator</span>
            <span class="n">a</span> <span class="o">^=</span> <span class="n">b</span> <span class="c"># testing __ixor__</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing buffer().&quot;</span>
        <span class="k">for</span> <span class="n">bg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">buffer_geoms</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-56"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-56">&#182;</a></div><p>The buffer we expect</p></td><td class="code"><div class="highlight"><pre>            <span class="n">exp_buf</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">buffer_wkt</span><span class="p">)</span>
            <span class="n">quadsegs</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">quadsegs</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">width</span></pre></div></td></tr>


<tr id="section-57"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-57">&#182;</a></div><p>Can't use a floating-point for the number of quadsegs.</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">ArgumentError</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">quadsegs</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-58"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-58">&#182;</a></div><p>Constructing our buffer</p></td><td class="code"><div class="highlight"><pre>            <span class="n">buf</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">quadsegs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">exp_buf</span><span class="o">.</span><span class="n">num_coords</span><span class="p">,</span> <span class="n">buf</span><span class="o">.</span><span class="n">num_coords</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exp_buf</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-59"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-59">&#182;</a></div><p>Now assuring that each point in the buffer is almost equal</p></td><td class="code"><div class="highlight"><pre>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exp_buf</span><span class="p">)):</span>
                <span class="n">exp_ring</span> <span class="o">=</span> <span class="n">exp_buf</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">buf_ring</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exp_ring</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf_ring</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exp_ring</span><span class="p">)):</span></pre></div></td></tr>


<tr id="section-60"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-60">&#182;</a></div><p>Asserting the X, Y of each point are almost equal (due to floating point imprecision)</p></td><td class="code"><div class="highlight"><pre>                    <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">exp_ring</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">buf_ring</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">exp_ring</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">buf_ring</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">9</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_srid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing the SRID property and keyword.&quot;</span></pre></div></td></tr>


<tr id="section-61"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-61">&#182;</a></div><p>Testing SRID keyword on Point</p></td><td class="code"><div class="highlight"><pre>        <span class="n">pnt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">4326</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>
        <span class="n">pnt</span><span class="o">.</span><span class="n">srid</span> <span class="o">=</span> <span class="mi">3084</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">3084</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">ArgumentError</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">set_srid</span><span class="p">,</span> <span class="s">&#39;4326&#39;</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-62"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-62">&#182;</a></div><p>Testing SRID keyword on fromstr(), and on Polygon rings.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">poly</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="mi">4269</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">4269</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ring</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">4269</span><span class="p">,</span> <span class="n">ring</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>
        <span class="n">poly</span><span class="o">.</span><span class="n">srid</span> <span class="o">=</span> <span class="mi">4326</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">4326</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-63"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-63">&#182;</a></div><p>Testing SRID keyword on GeometryCollection</p></td><td class="code"><div class="highlight"><pre>        <span class="n">gc</span> <span class="o">=</span> <span class="n">GeometryCollection</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="n">LineString</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">srid</span><span class="o">=</span><span class="mi">32021</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">32021</span><span class="p">,</span> <span class="n">gc</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gc</span><span class="p">)):</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">32021</span><span class="p">,</span> <span class="n">gc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-64"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-64">&#182;</a></div><p>GEOS may get the SRID from HEXEWKB
'POINT(5 23)' at SRID=4326 in hex form -- obtained from PostGIS
using <code>SELECT GeomFromText('POINT (5 23)', 4326);</code>.</p></td><td class="code"><div class="highlight"><pre>        <span class="nb">hex</span> <span class="o">=</span> <span class="s">&#39;0101000020E610000000000000000014400000000000003740&#39;</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="nb">hex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">4326</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-65"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-65">&#182;</a></div><p>In GEOS 3.0.0rc1-4  when the EWKB and/or HEXEWKB is exported,
the SRID information is lost and set to -1 -- this is not a
problem on the 3.0.0 version (another reason to upgrade).</p></td><td class="code"><div class="highlight"><pre>        <span class="n">exp_srid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">null_srid</span>

        <span class="n">p2</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">hex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">exp_srid</span><span class="p">,</span> <span class="n">p2</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>
        <span class="n">p3</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">hex</span><span class="p">,</span> <span class="n">srid</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c"># -1 is intended.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p3</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_mutable_geometries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing the mutability of Polygons and Geometry Collections.&quot;</span></pre></div></td></tr>


<tr id="section-66"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-66">&#182;</a></div><h2>Testing the mutability of Polygons</h2></td><td class="code"><div class="highlight"><pre>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">polygons</span><span class="p">:</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-67"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-67">&#182;</a></div><p>Should only be able to use <strong>setitem</strong> with LinearRing geometries.</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">LineString</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span></pre></div></td></tr>


<tr id="section-68"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-68">&#182;</a></div><p>Constructing the new shell by adding 500 to every point in the old shell.</p></td><td class="code"><div class="highlight"><pre>            <span class="n">shell_tup</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">tuple</span>
            <span class="n">new_coords</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">shell_tup</span><span class="p">:</span> <span class="n">new_coords</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">500.</span><span class="p">,</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">500.</span><span class="p">))</span>
            <span class="n">new_shell</span> <span class="o">=</span> <span class="n">LinearRing</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_coords</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-69"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-69">&#182;</a></div><p>Assigning polygon's exterior ring w/the new shell</p></td><td class="code"><div class="highlight"><pre>            <span class="n">poly</span><span class="o">.</span><span class="n">exterior_ring</span> <span class="o">=</span> <span class="n">new_shell</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_shell</span><span class="p">)</span> <span class="c"># new shell is still accessible</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">exterior_ring</span><span class="p">,</span> <span class="n">new_shell</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_shell</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-70"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-70">&#182;</a></div><h2>Testing the mutability of Geometry Collections</h2></td><td class="code"><div class="highlight"><pre>        <span class="k">for</span> <span class="n">tg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">multipoints</span><span class="p">:</span>
            <span class="n">mp</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mp</span><span class="p">)):</span></pre></div></td></tr>


<tr id="section-71"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-71">&#182;</a></div><p>Creating a random point.</p></td><td class="code"><div class="highlight"><pre>                <span class="n">pnt</span> <span class="o">=</span> <span class="n">mp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">new</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-72"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-72">&#182;</a></div><p>Testing the assignment</p></td><td class="code"><div class="highlight"><pre>                <span class="n">mp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span>
                <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> <span class="c"># what was used for the assignment is still accessible</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">new</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">new</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">pnt</span><span class="p">,</span> <span class="n">mp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></pre></div></td></tr>


<tr id="section-73"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-73">&#182;</a></div><p>MultiPolygons involve much more memory management because each
Polygon w/in the collection has its own rings.</p></td><td class="code"><div class="highlight"><pre>        <span class="k">for</span> <span class="n">tg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">multipolygons</span><span class="p">:</span>
            <span class="n">mpoly</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mpoly</span><span class="p">)):</span>
                <span class="n">poly</span> <span class="o">=</span> <span class="n">mpoly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">old_poly</span> <span class="o">=</span> <span class="n">mpoly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre></div></td></tr>


<tr id="section-74"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-74">&#182;</a></div><p>Offsetting the each ring in the polygon by 500.</p></td><td class="code"><div class="highlight"><pre>                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">)):</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">poly</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)):</span> <span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">500.</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">500.</span><span class="p">)</span>
                    <span class="n">poly</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">mpoly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">poly</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-75"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-75">&#182;</a></div><p>Testing the assignment</p></td><td class="code"><div class="highlight"><pre>                <span class="n">mpoly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span>
                <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span> <span class="c"># Still accessible</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mpoly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">poly</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">mpoly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">old_poly</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-76"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-76">&#182;</a></div><p>Extreme (!!) <strong>setitem</strong> -- no longer works, have to detect
in the first object that <strong>setitem</strong> is called in the subsequent
objects -- maybe mpoly[0, 0, 0] = (3.14, 2.71)?
mpoly[0][0][0] = (3.14, 2.71)
self.assertEqual((3.14, 2.71), mpoly[0][0][0])
Doing it more slowly..
self.assertEqual((3.14, 2.71), mpoly[0].shell[0])
del mpoly</p></td><td class="code"><div class="highlight"><pre>    <span class="k">def</span> <span class="nf">test_threed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing three-dimensional geometries.&quot;</span></pre></div></td></tr>


<tr id="section-77"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-77">&#182;</a></div><p>Testing a 3D Point</p></td><td class="code"><div class="highlight"><pre>        <span class="n">pnt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">8.</span><span class="p">),</span> <span class="n">pnt</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">set_coords</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">))</span>
        <span class="n">pnt</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">),</span> <span class="n">pnt</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-78"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-78">&#182;</a></div><p>Testing a 3D LineString</p></td><td class="code"><div class="highlight"><pre>        <span class="n">ls</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">((</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">),</span> <span class="p">(</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">250.</span><span class="p">,</span> <span class="o">-</span><span class="mf">117.</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(((</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">8.</span><span class="p">),</span> <span class="p">(</span><span class="mf">50.</span><span class="p">,</span><span class="mf">250.</span><span class="p">,</span><span class="o">-</span><span class="mf">117.</span><span class="p">)),</span> <span class="n">ls</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">ls</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">))</span>
        <span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">),</span> <span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing the distance() function.&quot;</span></pre></div></td></tr>


<tr id="section-79"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-79">&#182;</a></div><p>Distance to self should be 0.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">pnt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span></pre></div></td></tr>


<tr id="section-80"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-80">&#182;</a></div><p>Distance should be 1</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span></pre></div></td></tr>


<tr id="section-81"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-81">&#182;</a></div><p>Distance should be ~ sqrt(2)</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="mf">1.41421356237</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="mi">11</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-82"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-82">&#182;</a></div><p>Distances are from the closest vertex in each geometry --
 should be 3 (distance from (2, 2) to (5, 2)).</p></td><td class="code"><div class="highlight"><pre>        <span class="n">ls1</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">ls2</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls1</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">ls2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing the length property.&quot;</span></pre></div></td></tr>


<tr id="section-83"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-83">&#182;</a></div><p>Points have 0 length.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">pnt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">pnt</span><span class="o">.</span><span class="n">length</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-84"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-84">&#182;</a></div><p>Should be ~ sqrt(2)</p></td><td class="code"><div class="highlight"><pre>        <span class="n">ls</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="mf">1.41421356237</span><span class="p">,</span> <span class="n">ls</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-85"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-85">&#182;</a></div><p>Should be circumfrence of Polygon</p></td><td class="code"><div class="highlight"><pre>        <span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">LinearRing</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">length</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-86"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-86">&#182;</a></div><p>Should be sum of each element's length in collection.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">mpoly</span> <span class="o">=</span> <span class="n">MultiPolygon</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span> <span class="n">poly</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">mpoly</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_emptyCollections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing empty geometries and collections.&quot;</span>
        <span class="n">gc1</span> <span class="o">=</span> <span class="n">GeometryCollection</span><span class="p">([])</span>
        <span class="n">gc2</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;GEOMETRYCOLLECTION EMPTY&#39;</span><span class="p">)</span>
        <span class="n">pnt</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;POINT EMPTY&#39;</span><span class="p">)</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;LINESTRING EMPTY&#39;</span><span class="p">)</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;POLYGON EMPTY&#39;</span><span class="p">)</span>
        <span class="n">mls</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;MULTILINESTRING EMPTY&#39;</span><span class="p">)</span>
        <span class="n">mpoly1</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;MULTIPOLYGON EMPTY&#39;</span><span class="p">)</span>
        <span class="n">mpoly2</span> <span class="o">=</span> <span class="n">MultiPolygon</span><span class="p">(())</span>

        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="p">[</span><span class="n">gc1</span><span class="p">,</span> <span class="n">gc2</span><span class="p">,</span> <span class="n">pnt</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">poly</span><span class="p">,</span> <span class="n">mls</span><span class="p">,</span> <span class="n">mpoly1</span><span class="p">,</span> <span class="n">mpoly2</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-87"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-87">&#182;</a></div><p>Testing len() and num_geom.</p></td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">))</span> <span class="c"># Has one empty linear ring</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">num_geom</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="n">LineString</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">num_geom</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">num_geom</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-88"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-88">&#182;</a></div><p>Testing <strong>getitem</strong> (doesn't work on Point or Polygon)</p></td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">get_x</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">):</span>
                <span class="n">lr</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shell</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;LINEARRING EMPTY&#39;</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lr</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSIndexError</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_collections_of_collections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing GeometryCollection handling of other collections.&quot;</span></pre></div></td></tr>


<tr id="section-89"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-89">&#182;</a></div><p>Creating a GeometryCollection WKT string composed of other
collections and polygons.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">coll</span> <span class="o">=</span> <span class="p">[</span><span class="n">mp</span><span class="o">.</span><span class="n">wkt</span> <span class="k">for</span> <span class="n">mp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">multipolygons</span> <span class="k">if</span> <span class="n">mp</span><span class="o">.</span><span class="n">valid</span><span class="p">]</span>
        <span class="n">coll</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">mls</span><span class="o">.</span><span class="n">wkt</span> <span class="k">for</span> <span class="n">mls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">multilinestrings</span><span class="p">])</span>
        <span class="n">coll</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">wkt</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">polygons</span><span class="p">])</span>
        <span class="n">coll</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">mp</span><span class="o">.</span><span class="n">wkt</span> <span class="k">for</span> <span class="n">mp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">multipoints</span><span class="p">])</span>
        <span class="n">gc_wkt</span> <span class="o">=</span> <span class="s">&#39;GEOMETRYCOLLECTION(</span><span class="si">%s</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-90"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-90">&#182;</a></div><p>Should construct ok from WKT</p></td><td class="code"><div class="highlight"><pre>        <span class="n">gc1</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="n">gc_wkt</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-91"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-91">&#182;</a></div><p>Should also construct ok from individual geometry arguments.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">gc2</span> <span class="o">=</span> <span class="n">GeometryCollection</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gc1</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-92"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-92">&#182;</a></div><p>And, they should be equal.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">gc1</span><span class="p">,</span> <span class="n">gc2</span><span class="p">)</span>

    <span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="n">gdal</span><span class="o">.</span><span class="n">HAS_GDAL</span><span class="p">,</span> <span class="s">&quot;gdal is required&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_gdal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing `ogr` and `srs` properties.&quot;</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;POINT(5 23)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">ogr</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OGRGeometry</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">srs</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="n">g2</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;LINESTRING(0 0, 5 5, 23 23)&#39;</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g2</span><span class="o">.</span><span class="n">ogr</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OGRGeometry</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g2</span><span class="o">.</span><span class="n">srs</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g2</span><span class="o">.</span><span class="n">hex</span><span class="p">,</span> <span class="n">g2</span><span class="o">.</span><span class="n">ogr</span><span class="o">.</span><span class="n">hex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s">&#39;WGS 84&#39;</span><span class="p">,</span> <span class="n">g2</span><span class="o">.</span><span class="n">srs</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing use with the Python `copy` module.&quot;</span>
        <span class="kn">import</span> <span class="nn">copy</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POLYGON((0 0, 0 23, 23 23, 23 0, 0 0), (5 5, 5 10, 10 10, 10 5, 5 5))&#39;</span><span class="p">)</span>
        <span class="n">cpy1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
        <span class="n">cpy2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">_ptr</span><span class="p">,</span> <span class="n">cpy1</span><span class="o">.</span><span class="n">_ptr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">_ptr</span><span class="p">,</span> <span class="n">cpy2</span><span class="o">.</span><span class="n">_ptr</span><span class="p">)</span>

    <span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="n">gdal</span><span class="o">.</span><span class="n">HAS_GDAL</span><span class="p">,</span> <span class="s">&quot;gdal is required&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing `transform` method.&quot;</span>
        <span class="n">orig</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (992385.4472045 481455.4944650)&#39;</span><span class="p">,</span> <span class="mi">2774</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-93"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-93">&#182;</a></div><p>Using a srid, a SpatialReference object, and a CoordTransform object
for transformations.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span> <span class="o">=</span> <span class="n">orig</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span> <span class="n">orig</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span> <span class="n">orig</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="n">t1</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">trans</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>
        <span class="n">t2</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">gdal</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">(</span><span class="s">&#39;EPSG:2774&#39;</span><span class="p">))</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">CoordTransform</span><span class="p">(</span><span class="n">gdal</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">(</span><span class="s">&#39;WGS84&#39;</span><span class="p">),</span> <span class="n">gdal</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">(</span><span class="mi">2774</span><span class="p">))</span>
        <span class="n">t3</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-94"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-94">&#182;</a></div><p>Testing use of the <code>clone</code> keyword.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">k1</span> <span class="o">=</span> <span class="n">orig</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="n">k1</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">trans</span><span class="o">.</span><span class="n">srid</span><span class="p">,</span> <span class="n">clone</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">orig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">)</span>

        <span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">,</span> <span class="n">k2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">trans</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">trans</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_transform_noop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Testing `transform` method (SRID match) &quot;&quot;&quot;</span></pre></div></td></tr>


<tr id="section-95"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-95">&#182;</a></div><p>transform() should no-op if source &amp; dest SRIDs match,
regardless of whether GDAL is available.</p></td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="n">gdal</span><span class="o">.</span><span class="n">HAS_GDAL</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>
            <span class="n">gt</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">tuple</span>
            <span class="n">g</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="mi">4326</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">tuple</span><span class="p">,</span> <span class="n">gt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">srid</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>

            <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="mi">4326</span><span class="p">,</span> <span class="n">clone</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">tuple</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">srid</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">g1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">g</span><span class="p">,</span> <span class="s">&quot;Clone didn&#39;t happen&quot;</span><span class="p">)</span>

        <span class="n">old_has_gdal</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">HAS_GDAL</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">gdal</span><span class="o">.</span><span class="n">HAS_GDAL</span> <span class="o">=</span> <span class="bp">False</span>

            <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>
            <span class="n">gt</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">tuple</span>
            <span class="n">g</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="mi">4326</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">tuple</span><span class="p">,</span> <span class="n">gt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">srid</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>

            <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="mi">4326</span><span class="p">,</span> <span class="n">clone</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">tuple</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">tuple</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">srid</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">g1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">g</span><span class="p">,</span> <span class="s">&quot;Clone didn&#39;t happen&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">gdal</span><span class="o">.</span><span class="n">HAS_GDAL</span> <span class="o">=</span> <span class="n">old_has_gdal</span>

    <span class="k">def</span> <span class="nf">test_transform_nosrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Testing `transform` method (no SRID or negative SRID) &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="mi">2774</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="mi">2774</span><span class="p">,</span> <span class="n">clone</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="n">srid</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="mi">2774</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="n">srid</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="mi">2774</span><span class="p">,</span> <span class="n">clone</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_transform_nogdal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Testing `transform` method (GDAL not available) &quot;&quot;&quot;</span>
        <span class="n">old_has_gdal</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">HAS_GDAL</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">gdal</span><span class="o">.</span><span class="n">HAS_GDAL</span> <span class="o">=</span> <span class="bp">False</span>

            <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="mi">2774</span><span class="p">)</span>

            <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;POINT (-104.609 38.255)&#39;</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GEOSException</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="mi">2774</span><span class="p">,</span> <span class="n">clone</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">gdal</span><span class="o">.</span><span class="n">HAS_GDAL</span> <span class="o">=</span> <span class="n">old_has_gdal</span>

    <span class="k">def</span> <span class="nf">test_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing `extent` method.&quot;</span></pre></div></td></tr>


<tr id="section-96"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-96">&#182;</a></div><p>The xmin, ymin, xmax, ymax of the MultiPoint should be returned.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">mp</span> <span class="o">=</span> <span class="n">MultiPoint</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span> <span class="n">mp</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span>
        <span class="n">pnt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mf">5.23</span><span class="p">,</span> <span class="mf">17.8</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-97"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-97">&#182;</a></div><p>Extent of points is just the point itself repeated.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="mf">5.23</span><span class="p">,</span> <span class="mf">17.8</span><span class="p">,</span> <span class="mf">5.23</span><span class="p">,</span> <span class="mf">17.8</span><span class="p">),</span> <span class="n">pnt</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-98"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-98">&#182;</a></div><p>Testing on the 'real world' Polygon.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">poly</span> <span class="o">=</span> <span class="n">fromstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">wkt</span><span class="p">)</span>
        <span class="n">ring</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">shell</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ring</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ring</span><span class="o">.</span><span class="n">y</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="n">poly</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing pickling and unpickling support.&quot;</span></pre></div></td></tr>


<tr id="section-99"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-99">&#182;</a></div><p>Using both pickle and cPickle -- just 'cause.</p></td><td class="code"><div class="highlight"><pre>        <span class="kn">import</span> <span class="nn">pickle</span><span class="o">,</span> <span class="nn">cPickle</span></pre></div></td></tr>


<tr id="section-100"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-100">&#182;</a></div><p>Creating a list of test geometries for pickling,
and setting the SRID on some of them.</p></td><td class="code"><div class="highlight"><pre>        <span class="k">def</span> <span class="nf">get_geoms</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">GEOSGeometry</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">srid</span><span class="p">)</span> <span class="k">for</span> <span class="n">tg</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">]</span>
        <span class="n">tgeoms</span> <span class="o">=</span> <span class="n">get_geoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
        <span class="n">tgeoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_geoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">multilinestrings</span><span class="p">,</span> <span class="mi">4326</span><span class="p">))</span>
        <span class="n">tgeoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_geoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">polygons</span><span class="p">,</span> <span class="mi">3084</span><span class="p">))</span>
        <span class="n">tgeoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_geoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometries</span><span class="o">.</span><span class="n">multipolygons</span><span class="p">,</span> <span class="mi">900913</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-101"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-101">&#182;</a></div><p>The SRID won't be exported in GEOS 3.0 release candidates.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">no_srid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">null_srid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">tgeoms</span><span class="p">:</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">geom</span><span class="p">),</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
            <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s1</span><span class="p">),</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">tmpg</span> <span class="ow">in</span> <span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">tmpg</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">no_srid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">geom</span><span class="o">.</span><span class="n">srid</span><span class="p">,</span> <span class="n">tmpg</span><span class="o">.</span><span class="n">srid</span><span class="p">)</span>

    <span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="n">GEOS_PREPARE</span><span class="p">,</span> <span class="s">&quot;geos &gt;= 3.1.0 is required&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_prepared</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing PreparedGeometry support.&quot;</span></pre></div></td></tr>


<tr id="section-102"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-102">&#182;</a></div><p>Creating a simple multipolygon and getting a prepared version.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">mpoly</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&#39;MULTIPOLYGON(((0 0,0 5,5 5,5 0,0 0)),((5 5,5 10,10 10,10 5,5 5)))&#39;</span><span class="p">)</span>
        <span class="n">prep</span> <span class="o">=</span> <span class="n">mpoly</span><span class="o">.</span><span class="n">prepared</span></pre></div></td></tr>


<tr id="section-103"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-103">&#182;</a></div><p>A set of test points.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">pnts</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">)]</span>
        <span class="n">covers</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]</span> <span class="c"># No `covers` op for regular GEOS geoms.</span>
        <span class="k">for</span> <span class="n">pnt</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pnts</span><span class="p">,</span> <span class="n">covers</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-104"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-104">&#182;</a></div><p>Results should be the same (but faster)</p></td><td class="code"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mpoly</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pnt</span><span class="p">),</span> <span class="n">prep</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pnt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mpoly</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">pnt</span><span class="p">),</span> <span class="n">prep</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">pnt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">prep</span><span class="o">.</span><span class="n">covers</span><span class="p">(</span><span class="n">pnt</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_line_merge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing line merge support&quot;</span>
        <span class="n">ref_geoms</span> <span class="o">=</span> <span class="p">(</span><span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;LINESTRING(1 1, 1 1, 3 3)&#39;</span><span class="p">),</span>
                     <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;MULTILINESTRING((1 1, 3 3), (3 3, 4 2))&#39;</span><span class="p">),</span>
                     <span class="p">)</span>
        <span class="n">ref_merged</span> <span class="o">=</span> <span class="p">(</span><span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;LINESTRING(1 1, 3 3)&#39;</span><span class="p">),</span>
                      <span class="n">fromstr</span><span class="p">(</span><span class="s">&#39;LINESTRING (1 1, 3 3, 4 2)&#39;</span><span class="p">),</span>
                      <span class="p">)</span>
        <span class="k">for</span> <span class="n">geom</span><span class="p">,</span> <span class="n">merged</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ref_geoms</span><span class="p">,</span> <span class="n">ref_merged</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span> <span class="n">geom</span><span class="o">.</span><span class="n">merged</span><span class="p">)</span>

    <span class="nd">@unittest.skipUnless</span><span class="p">(</span><span class="n">GEOS_PREPARE</span><span class="p">,</span> <span class="s">&quot;geos &gt;= 3.1.0 is required&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_valid_reason</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing IsValidReason support&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&quot;POINT(0 0)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valid_reason</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valid_reason</span><span class="p">,</span> <span class="s">&quot;Valid Geometry&quot;</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">BEGIN - expecting GEOS_NOTICE; safe to ignore.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">GEOSGeometry</span><span class="p">(</span><span class="s">&quot;LINESTRING(0 0, 0 0)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valid_reason</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valid_reason</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;Too few points in geometry component&quot;</span><span class="p">))</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">END - expecting GEOS_NOTICE; safe to ignore.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_geos_version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Testing the GEOS version regular expression.&quot;</span>
        <span class="kn">from</span> <span class="nn">django.contrib.gis.geos.libgeos</span> <span class="kn">import</span> <span class="n">version_regex</span>
        <span class="n">versions</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;3.0.0rc4-CAPI-1.3.3&#39;</span><span class="p">,</span> <span class="s">&#39;3.0.0&#39;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s">&#39;3.0.0-CAPI-1.4.1&#39;</span><span class="p">,</span> <span class="s">&#39;3.0.0&#39;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s">&#39;3.4.0dev-CAPI-1.8.0&#39;</span><span class="p">,</span> <span class="s">&#39;3.4.0&#39;</span><span class="p">)</span> <span class="p">]</span>
        <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="n">versions</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">version_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;version&#39;</span><span class="p">),</span> <span class="n">expected</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">suite</span><span class="p">():</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestSuite</span><span class="p">()</span>
    <span class="n">s</span><span class="o">.</span><span class="n">addTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">makeSuite</span><span class="p">(</span><span class="n">GEOSTest</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">suite</span><span class="p">())</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/django",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
