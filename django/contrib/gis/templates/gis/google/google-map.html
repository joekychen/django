<!DOCTYPE html>
<html><head><title>joekychen/django » django › contrib › gis › templates › gis › google › google-map.js

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../../index.html"></a><h1>google-map.js</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="o">%</span> <span class="nx">load</span> <span class="nx">l10n</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">autoescape</span> <span class="nx">off</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">localize</span> <span class="nx">off</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">block</span> <span class="nx">vars</span> <span class="o">%</span><span class="p">}</span><span class="kd">var</span> <span class="nx">geodjango</span> <span class="o">=</span> <span class="p">{};{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">icon</span> <span class="k">in</span> <span class="nx">icons</span> <span class="o">%</span><span class="p">}</span>
<span class="kd">var</span> <span class="p">{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">varname</span> <span class="p">}}</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GIcon</span><span class="p">(</span><span class="nx">G_DEFAULT_ICON</span><span class="p">);</span>
<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">image</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">varname</span> <span class="p">}}.</span><span class="nx">image</span> <span class="o">=</span> <span class="s2">&quot;{{ icon.image }}&quot;</span><span class="p">;{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">shadow</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">varname</span> <span class="p">}}.</span><span class="nx">shadow</span> <span class="o">=</span> <span class="s2">&quot;{{ icon.shadow }}&quot;</span><span class="p">;{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">shadowsize</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">varname</span> <span class="p">}}.</span><span class="nx">shadowSize</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GSize</span><span class="p">({{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">shadowsize</span><span class="p">.</span><span class="mi">0</span> <span class="p">}},</span> <span class="p">{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">shadowsize</span><span class="p">.</span><span class="mi">1</span> <span class="p">}});{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">iconanchor</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">varname</span> <span class="p">}}.</span><span class="nx">iconAnchor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GPoint</span><span class="p">({{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">iconanchor</span><span class="p">.</span><span class="mi">0</span> <span class="p">}},</span> <span class="p">{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">iconanchor</span><span class="p">.</span><span class="mi">1</span> <span class="p">}});{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">iconsize</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">varname</span> <span class="p">}}.</span><span class="nx">iconSize</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GSize</span><span class="p">({{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">iconsize</span><span class="p">.</span><span class="mi">0</span> <span class="p">}},</span> <span class="p">{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">iconsize</span><span class="p">.</span><span class="mi">1</span> <span class="p">}});{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">infowindowanchor</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">varname</span> <span class="p">}}.</span><span class="nx">infoWindowAnchor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GPoint</span><span class="p">({{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">infowindowanchor</span><span class="p">.</span><span class="mi">0</span> <span class="p">}},</span> <span class="p">{{</span> <span class="nx">icon</span><span class="p">.</span><span class="nx">infowindowanchor</span><span class="p">.</span><span class="mi">1</span> <span class="p">}});{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">endblock</span> <span class="nx">vars</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="nx">block</span> <span class="nx">functions</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">block</span> <span class="nx">load</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_load</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">GBrowserIsCompatible</span><span class="p">())</span> <span class="p">{</span>
    <span class="p">{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GMap2</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;{{ dom_id }}&quot;</span><span class="p">));</span>
    <span class="p">{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}.</span><span class="nx">setCenter</span><span class="p">(</span><span class="k">new</span> <span class="nx">GLatLng</span><span class="p">({{</span> <span class="nx">center</span><span class="p">.</span><span class="mi">1</span> <span class="p">}},</span> <span class="p">{{</span> <span class="nx">center</span><span class="p">.</span><span class="mi">0</span> <span class="p">}}),</span> <span class="p">{{</span> <span class="nx">zoom</span> <span class="p">}});</span>
    <span class="p">{</span><span class="o">%</span> <span class="nx">block</span> <span class="nx">controls</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}.</span><span class="nx">setUIToDefault</span><span class="p">();{</span><span class="o">%</span> <span class="nx">endblock</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">calc_zoom</span> <span class="o">%</span><span class="p">}</span><span class="kd">var</span> <span class="nx">bounds</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GLatLngBounds</span><span class="p">();</span> <span class="kd">var</span> <span class="nx">tmp_bounds</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GLatLngBounds</span><span class="p">();{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">kml_url</span> <span class="k">in</span> <span class="nx">kml_urls</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_kml</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}}</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GGeoXml</span><span class="p">(</span><span class="s2">&quot;{{ kml_url }}&quot;</span><span class="p">);</span>
    <span class="p">{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}.</span><span class="nx">addOverlay</span><span class="p">({{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_kml</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}});{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">polygon</span> <span class="k">in</span> <span class="nx">polygons</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_poly</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}}</span> <span class="o">=</span> <span class="k">new</span> <span class="p">{{</span> <span class="nx">polygon</span> <span class="p">}};</span>
    <span class="p">{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}.</span><span class="nx">addOverlay</span><span class="p">({{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_poly</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}});</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">event</span> <span class="k">in</span> <span class="nx">polygon</span><span class="p">.</span><span class="nx">events</span> <span class="o">%</span><span class="p">}</span><span class="nx">GEvent</span><span class="p">.</span><span class="nx">addListener</span><span class="p">({{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_poly</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">parentloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}},</span> <span class="p">{{</span> <span class="nx">event</span> <span class="p">}});{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">calc_zoom</span> <span class="o">%</span><span class="p">}</span><span class="nx">tmp_bounds</span> <span class="o">=</span> <span class="p">{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_poly</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}}.</span><span class="nx">getBounds</span><span class="p">();</span> <span class="nx">bounds</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">tmp_bounds</span><span class="p">.</span><span class="nx">getSouthWest</span><span class="p">());</span> <span class="nx">bounds</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">tmp_bounds</span><span class="p">.</span><span class="nx">getNorthEast</span><span class="p">());{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">polyline</span> <span class="k">in</span> <span class="nx">polylines</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_polyline</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}}</span> <span class="o">=</span> <span class="k">new</span> <span class="p">{{</span> <span class="nx">polyline</span> <span class="p">}};</span>
    <span class="p">{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}.</span><span class="nx">addOverlay</span><span class="p">({{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_polyline</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}});</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">event</span> <span class="k">in</span> <span class="nx">polyline</span><span class="p">.</span><span class="nx">events</span> <span class="o">%</span><span class="p">}</span><span class="nx">GEvent</span><span class="p">.</span><span class="nx">addListener</span><span class="p">({{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_polyline</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">parentloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}},</span> <span class="p">{{</span> <span class="nx">event</span> <span class="p">}});</span> <span class="p">{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">calc_zoom</span> <span class="o">%</span><span class="p">}</span><span class="nx">tmp_bounds</span> <span class="o">=</span> <span class="p">{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_polyline</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}}.</span><span class="nx">getBounds</span><span class="p">();</span> <span class="nx">bounds</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">tmp_bounds</span><span class="p">.</span><span class="nx">getSouthWest</span><span class="p">());</span> <span class="nx">bounds</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">tmp_bounds</span><span class="p">.</span><span class="nx">getNorthEast</span><span class="p">());{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">marker</span> <span class="k">in</span> <span class="nx">markers</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_marker</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}}</span> <span class="o">=</span> <span class="k">new</span> <span class="p">{{</span> <span class="nx">marker</span> <span class="p">}};</span>
    <span class="p">{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}.</span><span class="nx">addOverlay</span><span class="p">({{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_marker</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}});</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">event</span> <span class="k">in</span> <span class="nx">marker</span><span class="p">.</span><span class="nx">events</span> <span class="o">%</span><span class="p">}</span><span class="nx">GEvent</span><span class="p">.</span><span class="nx">addListener</span><span class="p">({{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_marker</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">parentloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}},</span> <span class="p">{{</span> <span class="nx">event</span> <span class="p">}});</span> <span class="p">{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">calc_zoom</span> <span class="o">%</span><span class="p">}</span><span class="nx">bounds</span><span class="p">.</span><span class="nx">extend</span><span class="p">({{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}</span><span class="nx">_marker</span><span class="p">{{</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">counter</span> <span class="p">}}.</span><span class="nx">getLatLng</span><span class="p">());</span> <span class="p">{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">calc_zoom</span> <span class="o">%</span><span class="p">}{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}.</span><span class="nx">setCenter</span><span class="p">(</span><span class="nx">bounds</span><span class="p">.</span><span class="nx">getCenter</span><span class="p">(),</span> <span class="p">{{</span> <span class="nx">js_module</span> <span class="p">}}.{{</span> <span class="nx">dom_id</span> <span class="p">}}.</span><span class="nx">getBoundsZoomLevel</span><span class="p">(</span><span class="nx">bounds</span><span class="p">));{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="nx">block</span> <span class="nx">load_extra</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="nx">endblock</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Sorry, the Google Maps API is not compatible with this browser.&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">endblock</span> <span class="nx">load</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="nx">endblock</span> <span class="nx">functions</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="nx">endlocalize</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="nx">endautoescape</span> <span class="o">%</span><span class="p">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/django",depth:6}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../../javascript/docco.min.js"></script>
</html>
