<!DOCTYPE html>
<html><head><title>joekychen/django » tests › modeltests › lookup › tests.py

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>tests.py</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">unicode_literals</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">attrgetter</span>

<span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">FieldError</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">skipUnlessDBFeature</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Article</span><span class="p">,</span> <span class="n">Tag</span><span class="p">,</span> <span class="n">Game</span><span class="p">,</span> <span class="n">Season</span><span class="p">,</span> <span class="n">Player</span>


<span class="k">class</span> <span class="nc">LookupTests</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>Create a few Authors.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">au1</span> <span class="o">=</span> <span class="n">Author</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Author 1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">au2</span> <span class="o">=</span> <span class="n">Author</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Author 2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>Create a couple of Articles.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">a1</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article 1&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a2</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article 2&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a3</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article 3&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a4</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article 4&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a5</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article 5&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a6</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article 6&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a7</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article 7&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><p>Create a few Tags.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="n">Tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Tag 1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="o">.</span><span class="n">articles</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t2</span> <span class="o">=</span> <span class="n">Tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Tag 2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="o">.</span><span class="n">articles</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t3</span> <span class="o">=</span> <span class="n">Tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Tag 3&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="o">.</span><span class="n">articles</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-5"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-5">&#182;</a></div><p>We can use .exists() to check that there are some</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exists</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">a</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span></pre></div></td></tr>


<tr id="section-6"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-6">&#182;</a></div><p>There should be none now!</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exists</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">test_lookup_int_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-7"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-7">&#182;</a></div><p>Integer value can be queried using string</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">id__iexact</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">)),</span>
                                 <span class="p">[</span><span class="s">&#39;&lt;Article: Article 1&gt;&#39;</span><span class="p">])</span>

    <span class="nd">@skipUnlessDBFeature</span><span class="p">(</span><span class="s">&#39;supports_date_lookup_using_string&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_lookup_date_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-8"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-8">&#182;</a></div><p>A date lookup can be performed using a string search</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__startswith</span><span class="o">=</span><span class="s">&#39;2005&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: Article 5&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 6&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 4&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 2&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 3&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 7&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 1&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-9"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-9">&#182;</a></div><p>Each QuerySet gets iterator(), which is a generator that "lazily"
returns results using database-level iteration.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">iterator</span><span class="p">(),</span>
            <span class="p">[</span>
                <span class="s">&#39;Article 5&#39;</span><span class="p">,</span>
                <span class="s">&#39;Article 6&#39;</span><span class="p">,</span>
                <span class="s">&#39;Article 4&#39;</span><span class="p">,</span>
                <span class="s">&#39;Article 2&#39;</span><span class="p">,</span>
                <span class="s">&#39;Article 3&#39;</span><span class="p">,</span>
                <span class="s">&#39;Article 7&#39;</span><span class="p">,</span>
                <span class="s">&#39;Article 1&#39;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s">&#39;headline&#39;</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-10"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-10">&#182;</a></div><p>iterator() can be used on any QuerySet.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__endswith</span><span class="o">=</span><span class="s">&#39;4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterator</span><span class="p">(),</span>
            <span class="p">[</span><span class="s">&#39;Article 4&#39;</span><span class="p">],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s">&#39;headline&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-11"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-11">&#182;</a></div><p>count() returns the number of objects matching search criteria.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__exact</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">27</span><span class="p">))</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__startswith</span><span class="o">=</span><span class="s">&#39;Blah blah&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-12"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-12">&#182;</a></div><p>count() should respect sliced query sets.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">articles</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">articles</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">articles</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">articles</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">articles</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-13"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-13">&#182;</a></div><p>Date and date/time lookups can also be done with strings.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__exact</span><span class="o">=</span><span class="s">&#39;2005-07-27 00:00:00&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_in_bulk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-14"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-14">&#182;</a></div><p>in_bulk() takes a list of IDs and returns a dictionary mapping IDs to objects.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">arts</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">arts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">arts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">]),</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">])),</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">])),</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">,)),</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">([</span><span class="mi">1000</span><span class="p">]),</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">([]),</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">(</span><span class="nb">iter</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">])),</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">(</span><span class="nb">iter</span><span class="p">([])),</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">in_bulk</span><span class="p">,</span> <span class="n">headline__startswith</span><span class="o">=</span><span class="s">&#39;Blah&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-15"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-15">&#182;</a></div><p>values() returns a list of dictionaries instead of object instances --
and you can specify which fields you want to retrieve.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">identity</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;headline&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 5&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 6&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 4&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 2&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 3&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 7&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 1&#39;</span><span class="p">},</span>
            <span class="p">],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__exact</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">27</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">),</span>
            <span class="p">[{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="p">}],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;headline&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 5&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 6&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 4&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 2&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 3&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 7&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 1&#39;</span><span class="p">},</span>
            <span class="p">],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-16"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-16">&#182;</a></div><p>You can use values() with iterator() for memory savings,
because iterator() uses database-level iteration.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;headline&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterator</span><span class="p">(),</span>
            <span class="p">[</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 5&#39;</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 6&#39;</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 4&#39;</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 2&#39;</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 3&#39;</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 7&#39;</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 1&#39;</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">},</span>
            <span class="p">],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-17"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-17">&#182;</a></div><p>The values() method works with "extra" fields specified in extra(select).</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">extra</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="s">&#39;id + 1&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;id_plus_one&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">},</span>
            <span class="p">],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="s">&#39;id+1&#39;</span><span class="p">,</span>
            <span class="s">&#39;id_plus_two&#39;</span><span class="p">:</span> <span class="s">&#39;id+2&#39;</span><span class="p">,</span>
            <span class="s">&#39;id_plus_three&#39;</span><span class="p">:</span> <span class="s">&#39;id+3&#39;</span><span class="p">,</span>
            <span class="s">&#39;id_plus_four&#39;</span><span class="p">:</span> <span class="s">&#39;id+4&#39;</span><span class="p">,</span>
            <span class="s">&#39;id_plus_five&#39;</span><span class="p">:</span> <span class="s">&#39;id+5&#39;</span><span class="p">,</span>
            <span class="s">&#39;id_plus_six&#39;</span><span class="p">:</span> <span class="s">&#39;id+6&#39;</span><span class="p">,</span>
            <span class="s">&#39;id_plus_seven&#39;</span><span class="p">:</span> <span class="s">&#39;id+7&#39;</span><span class="p">,</span>
            <span class="s">&#39;id_plus_eight&#39;</span><span class="p">:</span> <span class="s">&#39;id+8&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">extra</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
            <span class="p">[{</span>
                <span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s">&#39;id_plus_two&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s">&#39;id_plus_three&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s">&#39;id_plus_four&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span>
                <span class="s">&#39;id_plus_five&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s">&#39;id_plus_six&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s">&#39;id_plus_seven&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span>
                <span class="s">&#39;id_plus_eight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span>
            <span class="p">}],</span> <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-18"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-18">&#182;</a></div><p>You can specify fields from forward and reverse relations, just like filter().</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;headline&#39;</span><span class="p">,</span> <span class="s">&#39;author__name&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;author__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;author__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;author__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;author__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;author__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;author__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;author__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
            <span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">headline</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">headline</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">headline</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">headline</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">headline</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">headline</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">headline</span><span class="p">},</span>
            <span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
            <span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-19"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-19">&#182;</a></div><p>However, an exception FieldDoesNotExist will be thrown if you specify
a non-existent field name in values() (a field that is neither in the
model nor in extra(select)).</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">FieldError</span><span class="p">,</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">extra</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="s">&#39;id + 1&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;id_plus_two&#39;</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-20"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-20">&#182;</a></div><p>If you don't specify field names to values(), all are returned.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
            <span class="p">[{</span>
                <span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="s">&#39;author_id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="s">&#39;headline&#39;</span><span class="p">:</span> <span class="s">&#39;Article 5&#39;</span><span class="p">,</span>
                <span class="s">&#39;pub_date&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">}],</span> <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_values_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-21"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-21">&#182;</a></div><p>values<em>list() is similar to values(), except that the results are
returned as a list of tuples, rather than a list of dictionaries.
Within each tuple, the order of the elements is the same as the order
of fields in the values</em>list() call.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">identity</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;headline&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="s">&#39;Article 5&#39;</span><span class="p">,),</span>
                <span class="p">(</span><span class="s">&#39;Article 6&#39;</span><span class="p">,),</span>
                <span class="p">(</span><span class="s">&#39;Article 4&#39;</span><span class="p">,),</span>
                <span class="p">(</span><span class="s">&#39;Article 2&#39;</span><span class="p">,),</span>
                <span class="p">(</span><span class="s">&#39;Article 3&#39;</span><span class="p">,),</span>
                <span class="p">(</span><span class="s">&#39;Article 7&#39;</span><span class="p">,),</span>
                <span class="p">(</span><span class="s">&#39;Article 1&#39;</span><span class="p">,),</span>
            <span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">),</span>
            <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="p">,)],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="p">],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">extra</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="s">&#39;id+1&#39;</span><span class="p">})</span>
                           <span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">),</span>
            <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="p">,)],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">extra</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="s">&#39;id+1&#39;</span><span class="p">})</span>
                           <span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id_plus_one&#39;</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">extra</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;id_plus_one&#39;</span><span class="p">:</span> <span class="s">&#39;id+1&#39;</span><span class="p">})</span>
                           <span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;id_plus_one&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;article__headline&#39;</span><span class="p">,</span> <span class="s">&#39;article__tag__name&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">au1</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">au2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">headline</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
            <span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values_list</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;headline&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_get_next_previous_by</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-22"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-22">&#182;</a></div><p>Every DateField and DateTimeField creates get<em>next</em>by<em>FOO() and
get</em>previous<em>by</em>FOO() methods. In the case of identical date values,
these methods will use the ID as a fallback check. This guarantees
that no records are skipped or duplicated.</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">get_next_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 2&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">get_next_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 3&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">get_next_by_pub_date</span><span class="p">(</span><span class="n">headline__endswith</span><span class="o">=</span><span class="s">&#39;6&#39;</span><span class="p">)),</span>
                         <span class="s">&#39;&lt;Article: Article 6&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">get_next_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 7&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">get_next_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 6&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">get_next_by_pub_date</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">get_next_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 5&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">get_next_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 4&gt;&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="o">.</span><span class="n">get_previous_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 3&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="o">.</span><span class="n">get_previous_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 4&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="o">.</span><span class="n">get_previous_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 6&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="o">.</span><span class="n">get_previous_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 7&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">get_previous_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 2&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">get_previous_by_pub_date</span><span class="p">()),</span>
                         <span class="s">&#39;&lt;Article: Article 1&gt;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_escaping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-23"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-23">&#182;</a></div><p>Underscores, percent signs and backslashes have special meaning in the
underlying SQL code, but Django handles the quoting of them automatically.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">a8</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article_ with underscore&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
        <span class="n">a8</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__startswith</span><span class="o">=</span><span class="s">&#39;Article&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: Article_ with underscore&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 5&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 6&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 4&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 2&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 3&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 7&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 1&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__startswith</span><span class="o">=</span><span class="s">&#39;Article_&#39;</span><span class="p">),</span>
                                 <span class="p">[</span><span class="s">&#39;&lt;Article: Article_ with underscore&gt;&#39;</span><span class="p">])</span>
        <span class="n">a9</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article% with percent sign&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
        <span class="n">a9</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__startswith</span><span class="o">=</span><span class="s">&#39;Article&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: Article% with percent sign&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article_ with underscore&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 5&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 6&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 4&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 2&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 3&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 7&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 1&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__startswith</span><span class="o">=</span><span class="s">&#39;Article%&#39;</span><span class="p">),</span>
                                 <span class="p">[</span><span class="s">&#39;&lt;Article: Article% with percent sign&gt;&#39;</span><span class="p">])</span>
        <span class="n">a10</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article with </span><span class="se">\\</span><span class="s"> backslash&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
        <span class="n">a10</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__contains</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">),</span>
                                 <span class="p">[</span><span class="s">&#39;&lt;Article: Article with \ backslash&gt;&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_exclude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a8</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article_ with underscore&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
        <span class="n">a9</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article% with percent sign&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
        <span class="n">a10</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&#39;Article with </span><span class="se">\\</span><span class="s"> backslash&#39;</span><span class="p">,</span> <span class="n">pub_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span></pre></div></td></tr>


<tr id="section-24"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-24">&#182;</a></div><p>exclude() is the opposite of filter() when doing lookups:</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__contains</span><span class="o">=</span><span class="s">&#39;Article&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">headline__contains</span><span class="o">=</span><span class="s">&#39;with&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: Article 5&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 6&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 4&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 2&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 3&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 7&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 1&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">headline__startswith</span><span class="o">=</span><span class="s">&quot;Article_&quot;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: Article with </span><span class="se">\\</span><span class="s"> backslash&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article% with percent sign&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 5&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 6&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 4&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 2&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 3&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 7&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 1&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&quot;Article 7&quot;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: Article with </span><span class="se">\\</span><span class="s"> backslash&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article% with percent sign&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article_ with underscore&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 5&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 6&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 4&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 2&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 3&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 1&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_none</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-25"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-25">&#182;</a></div><p>none() returns an EmptyQuerySet that behaves like any other QuerySet object</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">none</span><span class="p">(),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">none</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__startswith</span><span class="o">=</span><span class="s">&#39;Article&#39;</span><span class="p">),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__startswith</span><span class="o">=</span><span class="s">&#39;Article&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">none</span><span class="p">(),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">none</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">none</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s">&quot;This should not take effect&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span>
            <span class="p">[</span><span class="n">article</span> <span class="k">for</span> <span class="n">article</span> <span class="ow">in</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">none</span><span class="p">()</span><span class="o">.</span><span class="n">iterator</span><span class="p">()],</span>
            <span class="p">[])</span>

    <span class="k">def</span> <span class="nf">test_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-26"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-26">&#182;</a></div><p>using __in with an empty list should return an empty query set</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">id__in</span><span class="o">=</span><span class="p">[]),</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">id__in</span><span class="o">=</span><span class="p">[]),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: Article 5&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 6&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 4&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 2&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 3&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 7&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: Article 1&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_error_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-27"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-27">&#182;</a></div><p>Programming errors are pointed out with nice error messages</p></td><td class="code"><div class="highlight"><pre>        <span class="k">try</span><span class="p">:</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date_year</span><span class="o">=</span><span class="s">&#39;2005&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;FieldError not raised&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">FieldError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">),</span> <span class="s">&quot;Cannot resolve keyword &#39;pub_date_year&#39; &quot;</span>
                             <span class="s">&quot;into field. Choices are: author, headline, id, pub_date, tag&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__starts</span><span class="o">=</span><span class="s">&#39;Article&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s">&#39;FieldError not raised&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">FieldError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">),</span> <span class="s">&quot;Join on field &#39;headline&#39; not permitted. &quot;</span>
                             <span class="s">&quot;Did you misspell &#39;starts&#39; for the lookup type?&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_regex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-28"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-28">&#182;</a></div><p>Create some articles with a bit more interesting headlines for testing field lookups:</p></td><td class="code"><div class="highlight"><pre>        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">a</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;f&#39;</span><span class="p">)</span>
        <span class="n">a1</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;fo&#39;</span><span class="p">)</span>
        <span class="n">a2</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a3</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;foo&#39;</span><span class="p">)</span>
        <span class="n">a3</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a4</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;fooo&#39;</span><span class="p">)</span>
        <span class="n">a4</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a5</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;hey-Foo&#39;</span><span class="p">)</span>
        <span class="n">a5</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a6</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;bar&#39;</span><span class="p">)</span>
        <span class="n">a6</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a7</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;AbBa&#39;</span><span class="p">)</span>
        <span class="n">a7</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a8</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;baz&#39;</span><span class="p">)</span>
        <span class="n">a8</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a9</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;baxZ&#39;</span><span class="p">)</span>
        <span class="n">a9</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div></td></tr>


<tr id="section-29"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-29">&#182;</a></div><p>zero-or-more</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;fo*&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: f&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: fo&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: foo&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: fooo&gt;&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__iregex</span><span class="o">=</span><span class="s">r&#39;fo*&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: f&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: fo&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foo&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: fooo&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: hey-Foo&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span></pre></div></td></tr>


<tr id="section-30"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-30">&#182;</a></div><p>one-or-more</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;fo+&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: fo&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: foo&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: fooo&gt;&#39;</span><span class="p">])</span></pre></div></td></tr>


<tr id="section-31"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-31">&#182;</a></div><p>wildcard</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;fooo?&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: foo&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: fooo&gt;&#39;</span><span class="p">])</span></pre></div></td></tr>


<tr id="section-32"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-32">&#182;</a></div><p>leading anchor</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;^b&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: bar&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: baxZ&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: baz&gt;&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__iregex</span><span class="o">=</span><span class="s">r&#39;^a&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: AbBa&gt;&#39;</span><span class="p">])</span></pre></div></td></tr>


<tr id="section-33"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-33">&#182;</a></div><p>trailing anchor</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;z$&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: baz&gt;&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__iregex</span><span class="o">=</span><span class="s">r&#39;z$&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: baxZ&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: baz&gt;&#39;</span><span class="p">])</span></pre></div></td></tr>


<tr id="section-34"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-34">&#182;</a></div><p>character sets</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;ba[rz]&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: bar&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: baz&gt;&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;ba.[RxZ]&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: baxZ&gt;&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__iregex</span><span class="o">=</span><span class="s">r&#39;ba[RxZ]&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: bar&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: baxZ&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: baz&gt;&#39;</span><span class="p">])</span></pre></div></td></tr>


<tr id="section-35"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-35">&#182;</a></div><p>and more articles:</p></td><td class="code"><div class="highlight"><pre>        <span class="n">a10</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;foobar&#39;</span><span class="p">)</span>
        <span class="n">a10</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a11</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;foobaz&#39;</span><span class="p">)</span>
        <span class="n">a11</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a12</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;ooF&#39;</span><span class="p">)</span>
        <span class="n">a12</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a13</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;foobarbaz&#39;</span><span class="p">)</span>
        <span class="n">a13</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a14</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;zoocarfaz&#39;</span><span class="p">)</span>
        <span class="n">a14</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a15</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;barfoobaz&#39;</span><span class="p">)</span>
        <span class="n">a15</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a16</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;bazbaRFOO&#39;</span><span class="p">)</span>
        <span class="n">a16</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div></td></tr>


<tr id="section-36"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-36">&#182;</a></div><p>alternation</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;oo(f|b)&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: barfoobaz&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foobar&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foobarbaz&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foobaz&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__iregex</span><span class="o">=</span><span class="s">r&#39;oo(f|b)&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: barfoobaz&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foobar&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foobarbaz&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foobaz&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: ooF&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;^foo(f|b)&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: foobar&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: foobarbaz&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: foobaz&gt;&#39;</span><span class="p">])</span></pre></div></td></tr>


<tr id="section-37"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-37">&#182;</a></div><p>greedy matching</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;b.*az&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: barfoobaz&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: baz&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: bazbaRFOO&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foobarbaz&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foobaz&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__iregex</span><span class="o">=</span><span class="s">r&#39;b.*ar&#39;</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="s">&#39;&lt;Article: bar&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: barfoobaz&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: bazbaRFOO&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foobar&gt;&#39;</span><span class="p">,</span>
                <span class="s">&#39;&lt;Article: foobarbaz&gt;&#39;</span><span class="p">,</span>
            <span class="p">])</span>

    <span class="nd">@skipUnlessDBFeature</span><span class="p">(</span><span class="s">&#39;supports_regex_backreferencing&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_regex_backreferencing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div></td></tr>


<tr id="section-38"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-38">&#182;</a></div><p>grouping and backreferences</p></td><td class="code"><div class="highlight"><pre>        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">a10</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;foobar&#39;</span><span class="p">)</span>
        <span class="n">a10</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a11</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;foobaz&#39;</span><span class="p">)</span>
        <span class="n">a11</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a12</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;ooF&#39;</span><span class="p">)</span>
        <span class="n">a12</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a13</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;foobarbaz&#39;</span><span class="p">)</span>
        <span class="n">a13</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a14</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;zoocarfaz&#39;</span><span class="p">)</span>
        <span class="n">a14</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a15</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;barfoobaz&#39;</span><span class="p">)</span>
        <span class="n">a15</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">a16</span> <span class="o">=</span> <span class="n">Article</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">headline</span><span class="o">=</span><span class="s">&#39;bazbaRFOO&#39;</span><span class="p">)</span>
        <span class="n">a16</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__regex</span><span class="o">=</span><span class="s">r&#39;b(.).*b\1&#39;</span><span class="p">),</span>
            <span class="p">[</span><span class="s">&#39;&lt;Article: barfoobaz&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: bazbaRFOO&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;Article: foobarbaz&gt;&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_nonfield_lookups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ensure that a lookup query containing non-fields raises the proper</span>
<span class="sd">        exception.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">FieldError</span><span class="p">):</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__blahblah</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">FieldError</span><span class="p">):</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__blahblah__exact</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">FieldError</span><span class="p">):</span>
            <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blahblah</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_lookup_collision</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ensure that genuine field names don&#39;t collide with built-in lookup</span>
<span class="sd">        types (&#39;year&#39;, &#39;gt&#39;, &#39;range&#39;, &#39;in&#39; etc.).</span>
<span class="sd">        Refs #11670.</span>
<span class="sd">        &quot;&quot;&quot;</span></pre></div></td></tr>


<tr id="section-39"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-39">&#182;</a></div><p>Here we're using 'gt' as a code number for the year, e.g. 111=>2009.</p></td><td class="code"><div class="highlight"><pre>        <span class="n">season_2009</span> <span class="o">=</span> <span class="n">Season</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2009</span><span class="p">,</span> <span class="n">gt</span><span class="o">=</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">season_2009</span><span class="o">.</span><span class="n">games</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">home</span><span class="o">=</span><span class="s">&quot;Houston Astros&quot;</span><span class="p">,</span> <span class="n">away</span><span class="o">=</span><span class="s">&quot;St. Louis Cardinals&quot;</span><span class="p">)</span>
        <span class="n">season_2010</span> <span class="o">=</span> <span class="n">Season</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span> <span class="n">gt</span><span class="o">=</span><span class="mi">222</span><span class="p">)</span>
        <span class="n">season_2010</span><span class="o">.</span><span class="n">games</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">home</span><span class="o">=</span><span class="s">&quot;Houston Astros&quot;</span><span class="p">,</span> <span class="n">away</span><span class="o">=</span><span class="s">&quot;Chicago Cubs&quot;</span><span class="p">)</span>
        <span class="n">season_2010</span><span class="o">.</span><span class="n">games</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">home</span><span class="o">=</span><span class="s">&quot;Houston Astros&quot;</span><span class="p">,</span> <span class="n">away</span><span class="o">=</span><span class="s">&quot;Milwaukee Brewers&quot;</span><span class="p">)</span>
        <span class="n">season_2010</span><span class="o">.</span><span class="n">games</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">home</span><span class="o">=</span><span class="s">&quot;Houston Astros&quot;</span><span class="p">,</span> <span class="n">away</span><span class="o">=</span><span class="s">&quot;St. Louis Cardinals&quot;</span><span class="p">)</span>
        <span class="n">season_2011</span> <span class="o">=</span> <span class="n">Season</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2011</span><span class="p">,</span> <span class="n">gt</span><span class="o">=</span><span class="mi">333</span><span class="p">)</span>
        <span class="n">season_2011</span><span class="o">.</span><span class="n">games</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">home</span><span class="o">=</span><span class="s">&quot;Houston Astros&quot;</span><span class="p">,</span> <span class="n">away</span><span class="o">=</span><span class="s">&quot;St. Louis Cardinals&quot;</span><span class="p">)</span>
        <span class="n">season_2011</span><span class="o">.</span><span class="n">games</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">home</span><span class="o">=</span><span class="s">&quot;Houston Astros&quot;</span><span class="p">,</span> <span class="n">away</span><span class="o">=</span><span class="s">&quot;Milwaukee Brewers&quot;</span><span class="p">)</span>
        <span class="n">hunter_pence</span> <span class="o">=</span> <span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Hunter Pence&quot;</span><span class="p">)</span>
        <span class="n">hunter_pence</span><span class="o">.</span><span class="n">games</span> <span class="o">=</span> <span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year__in</span><span class="o">=</span><span class="p">[</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">])</span>
        <span class="n">pudge</span> <span class="o">=</span> <span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Ivan Rodriquez&quot;</span><span class="p">)</span>
        <span class="n">pudge</span><span class="o">.</span><span class="n">games</span> <span class="o">=</span> <span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year</span><span class="o">=</span><span class="mi">2009</span><span class="p">)</span>
        <span class="n">pedro_feliz</span> <span class="o">=</span> <span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Pedro Feliz&quot;</span><span class="p">)</span>
        <span class="n">pedro_feliz</span><span class="o">.</span><span class="n">games</span> <span class="o">=</span> <span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year__in</span><span class="o">=</span><span class="p">[</span><span class="mi">2011</span><span class="p">])</span>
        <span class="n">johnson</span> <span class="o">=</span> <span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Johnson&quot;</span><span class="p">)</span>
        <span class="n">johnson</span><span class="o">.</span><span class="n">games</span> <span class="o">=</span> <span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year__in</span><span class="o">=</span><span class="p">[</span><span class="mi">2011</span><span class="p">])</span></pre></div></td></tr>


<tr id="section-40"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-40">&#182;</a></div><p>Games in 2010</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year</span><span class="o">=</span><span class="mi">2010</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year__exact</span><span class="o">=</span><span class="mi">2010</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__gt</span><span class="o">=</span><span class="mi">222</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__gt__exact</span><span class="o">=</span><span class="mi">222</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-41"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-41">&#182;</a></div><p>Games in 2011</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year</span><span class="o">=</span><span class="mi">2011</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year__exact</span><span class="o">=</span><span class="mi">2011</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__gt</span><span class="o">=</span><span class="mi">333</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__gt__exact</span><span class="o">=</span><span class="mi">333</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year__gt</span><span class="o">=</span><span class="mi">2010</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__gt__gt</span><span class="o">=</span><span class="mi">222</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-42"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-42">&#182;</a></div><p>Games played in 2010 and 2011</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year__in</span><span class="o">=</span><span class="p">[</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__year__gt</span><span class="o">=</span><span class="mi">2009</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__gt__in</span><span class="o">=</span><span class="p">[</span><span class="mi">222</span><span class="p">,</span> <span class="mi">333</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Game</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">season__gt__gt</span><span class="o">=</span><span class="mi">111</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">5</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-43"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-43">&#182;</a></div><p>Players who played in 2009</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__year</span><span class="o">=</span><span class="mi">2009</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__year__exact</span><span class="o">=</span><span class="mi">2009</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__gt</span><span class="o">=</span><span class="mi">111</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__gt__exact</span><span class="o">=</span><span class="mi">111</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-44"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-44">&#182;</a></div><p>Players who played in 2010</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__year</span><span class="o">=</span><span class="mi">2010</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__year__exact</span><span class="o">=</span><span class="mi">2010</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__gt</span><span class="o">=</span><span class="mi">222</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__gt__exact</span><span class="o">=</span><span class="mi">222</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span></pre></div></td></tr>


<tr id="section-45"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-45">&#182;</a></div><p>Players who played in 2011</p></td><td class="code"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__year</span><span class="o">=</span><span class="mi">2011</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__year__exact</span><span class="o">=</span><span class="mi">2011</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__gt</span><span class="o">=</span><span class="mi">333</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__year__gt</span><span class="o">=</span><span class="mi">2010</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Player</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">games__season__gt__gt</span><span class="o">=</span><span class="mi">222</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/django",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
